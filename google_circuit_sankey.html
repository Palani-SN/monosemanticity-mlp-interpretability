
    <!DOCTYPE html>
    <html>
    <head>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <style>
            body { font-family: 'Inter', -apple-system, sans-serif; background: #ffffff; margin: 0; padding: 20px; }
            #sankey_main { width: 100%; height: 850px; min-width: 1200px; }
            .header { text-align: center; margin-bottom: 20px; }
        </style>
    </head>
    <body>
        <div class="header">
            <h2>Mechanistic Interpretability: End-to-End Circuit Flow</h2>
            <p>Hover over nodes to see causal trace intensity</p>
        </div>
        <div id="sankey_main"></div>

        <script type="text/javascript">
          google.charts.load('current', {'packages':['sankey']});
          google.charts.setOnLoadCallback(drawChart);

          function drawChart() {
            var data = new google.visualization.DataTable();
            data.addColumn('string', 'From');
            data.addColumn('string', 'To');
            data.addColumn('number', 'Weight');
            data.addRows([["Idx: 0-0", "Val: 0-7", 189.6834], ["Idx: 1-0", "Val: 9-0", 173.8885], ["Idx: 3-0", "Val: 0-2", 154.5963], ["Idx: 3-0", "Val: 6-9", 143.193], ["Idx: 3-3", "Val: 8-8", 142.5442], ["Idx: 0-0", "Val: 9-8", 140.7994], ["Idx: 3-0", "Val: 1-0", 136.8504], ["Idx: 3-0", "Val: 7-9", 135.5447], ["Idx: 3-0", "Val: 0-3", 134.7259], ["Idx: 3-0", "Val: 4-1", 134.0695], ["Idx: 0-0", "Val: 9-0", 132.9408], ["Idx: 0-0", "Val: 0-9", 130.255], ["Idx: 3-3", "Val: 6-9", 129.9622], ["Idx: 3-0", "Val: 1-1", 126.0274], ["Idx: 0-0", "Val: 6-3", 124.1069], ["Idx: 0-0", "Val: 0-6", 122.8928], ["Idx: 3-2", "Val: 6-6", 122.5655], ["Idx: 3-3", "Val: 2-0", 122.559], ["Idx: 1-0", "Val: 5-0", 121.999], ["Idx: 3-0", "Val: 5-0", 121.6495], ["Idx: 3-3", "Val: 1-9", 120.5784], ["Idx: 3-0", "Val: 0-0", 119.7846], ["Idx: 3-3", "Val: 9-8", 118.7505], ["Idx: 0-3", "Val: 1-9", 117.6788], ["Idx: 0-0", "Val: 7-0", 116.2884], ["Idx: 3-0", "Val: 9-6", 115.1856], ["Idx: 3-3", "Val: 5-0", 112.9664], ["Idx: 1-3", "Val: 4-9", 111.2797], ["Idx: 3-3", "Val: 7-6", 110.6893], ["Idx: 3-2", "Val: 9-9", 109.7848], ["Idx: 3-3", "Val: 8-3", 109.1478], ["Idx: 3-0", "Val: 5-1", 108.6587], ["Idx: 3-3", "Val: 0-6", 108.608], ["Idx: 3-0", "Val: 3-7", 108.5517], ["Idx: 0-3", "Val: 0-2", 107.5338], ["Idx: 0-3", "Val: 2-8", 107.2823], ["Idx: 3-0", "Val: 2-5", 107.0605], ["Val: 0-6", "Neu: 298", 162.5194], ["Val: 0-8", "Neu: 298", 159.497], ["Val: 0-7", "Neu: 298", 150.8061], ["Val: 0-9", "Neu: 298", 142.7709], ["Val: 0-3", "Neu: 298", 141.9658], ["Val: 0-2", "Neu: 257", 141.019], ["Val: 0-2", "Neu: 298", 140.6573], ["Val: 0-9", "Neu: 257", 136.2858], ["Val: 0-4", "Neu: 257", 136.1478], ["Val: 0-4", "Neu: 298", 135.724], ["Val: 0-6", "Neu: 257", 130.7832], ["Val: 0-1", "Neu: 298", 124.715], ["Val: 0-3", "Neu: 257", 122.7391], ["Val: 9-0", "Neu: 287", 119.1798], ["Val: 0-8", "Neu: 257", 118.0899], ["Val: 0-7", "Neu: 257", 117.5491], ["Val: 0-1", "Neu: 257", 116.4875], ["Val: 0-0", "Neu: 298", 116.1351], ["Val: 0-5", "Neu: 298", 115.3831], ["Val: 0-5", "Neu: 257", 108.6465], ["Val: 0-0", "Neu: 257", 99.7164], ["Val: 5-0", "Neu: 287", 96.9092], ["Val: 1-9", "Neu: 200", 91.8921], ["Val: 1-0", "Neu: 287", 91.5218], ["Val: 9-4", "Neu: 402", 89.0975], ["Val: 9-8", "Neu: 402", 88.6907], ["Val: 8-0", "Neu: 287", 87.0451], ["Val: 9-7", "Neu: 402", 84.8936], ["Val: 1-1", "Neu: 257", 84.0554], ["Val: 1-5", "Neu: 298", 81.0882], ["Val: 6-9", "Neu: 200", 80.7332], ["Val: 1-7", "Neu: 298", 79.5663], ["Val: 6-0", "Neu: 287", 78.8964], ["Val: 9-2", "Neu: 402", 78.4444], ["Val: 4-0", "Neu: 287", 78.1961], ["Val: 7-0", "Neu: 287", 77.6492], ["Val: 9-1", "Neu: 402", 76.6648], ["Neu: 298", "Feat: 1154", 1568.58], ["Neu: 257", "Feat: 697", 1181.0073], ["Neu: 160", "Feat: 730", 1047.4194], ["Neu: 345", "Feat: 926", 1034.9797], ["Neu: 298", "Feat: 1585", 813.655], ["Neu: 386", "Feat: 1617", 723.4929], ["Neu: 287", "Feat: 278", 489.4904], ["Neu: 106", "Feat: 1673", 488.5707], ["Neu: 219", "Feat: 127", 451.4181], ["Neu: 244", "Feat: 369", 406.6519], ["Neu: 287", "Feat: 282", 392.8294], ["Neu: 277", "Feat: 1673", 352.6635], ["Neu: 219", "Feat: 12", 351.8329], ["Neu: 200", "Feat: 1617", 340.1084], ["Neu: 257", "Feat: 1781", 339.1585], ["Neu: 160", "Feat: 1154", 292.4013], ["Neu: 160", "Feat: 1617", 266.9291], ["Neu: 219", "Feat: 278", 263.4985], ["Neu: 402", "Feat: 642", 255.0098], ["Neu: 471", "Feat: 334", 250.7666], ["Neu: 68", "Feat: 926", 249.116], ["Neu: 510", "Feat: 1617", 247.9165], ["Neu: 160", "Feat: 369", 237.4826], ["Neu: 200", "Feat: 783", 235.7619], ["Neu: 257", "Feat: 1588", 233.0828], ["Neu: 510", "Feat: 783", 227.1984], ["Neu: 471", "Feat: 1676", 223.4435], ["Neu: 471", "Feat: 278", 218.2353], ["Neu: 471", "Feat: 1195", 216.4334], ["Neu: 219", "Feat: 334", 196.8905], ["Neu: 160", "Feat: 282", 195.5889], ["Neu: 492", "Feat: 94", 190.8869], ["Neu: 68", "Feat: 634", 172.5911], ["Neu: 345", "Feat: 1588", 167.3491], ["Neu: 298", "Feat: 1617", 165.8592], ["Neu: 402", "Feat: 1617", 162.9323], ["Neu: 106", "Feat: 1588", 147.8377], ["Feat: 1617", "Out: 1", 542.2106], ["Feat: 1617", "Out: 2", 492.9187], ["Feat: 1617", "Out: 3", 420.9242], ["Feat: 926", "Out: 1", 401.971], ["Feat: 730", "Out: 1", 376.8804], ["Feat: 1617", "Out: 4", 359.5527], ["Feat: 926", "Out: 2", 340.4486], ["Feat: 730", "Out: 2", 338.8393], ["Feat: 1617", "Out: 5", 335.3254], ["Feat: 783", "Out: 1", 334.687], ["Feat: 1673", "Out: 1", 326.4154], ["Feat: 1673", "Out: 2", 302.6139], ["Feat: 730", "Out: 3", 292.0287], ["Feat: 1617", "Out: 0", 285.3278], ["Feat: 926", "Out: 3", 283.6418], ["Feat: 127", "Out: 2", 281.7849], ["Feat: 369", "Out: 1", 280.9466], ["Feat: 1585", "Out: 1", 279.0613], ["Feat: 282", "Out: 2", 276.0933], ["Feat: 1154", "Out: 1", 274.0401], ["Feat: 783", "Out: 2", 272.6625], ["Feat: 127", "Out: 1", 270.6698], ["Feat: 1588", "Out: 1", 268.8751], ["Feat: 1154", "Out: 2", 268.5391], ["Feat: 282", "Out: 1", 263.7572], ["Feat: 127", "Out: 3", 261.698], ["Feat: 1154", "Out: 6", 257.9039], ["Feat: 1585", "Out: 2", 256.2119], ["Feat: 369", "Out: 2", 253.1188], ["Feat: 1154", "Out: 4", 251.7885], ["Feat: 783", "Out: 3", 250.4505], ["Feat: 1154", "Out: 3", 246.3528], ["Feat: 282", "Out: 3", 245.603], ["Feat: 926", "Out: 0", 243.4296], ["Feat: 1585", "Out: 3", 242.6807], ["Feat: 1617", "Out: 6", 242.1413], ["Feat: 926", "Out: 4", 240.8192]]);

            // Styling based on your reference image
            var colors = ['#a6cee3', '#b2df8a', '#fb9a99', '#fdbf6f',
                          '#cab2d6', '#ffff99', '#1f78b4', '#33a02c'];

            var options = {
              height: 800,
              sankey: {
                node: {
                  colors: colors,
                  label: { fontSize: 12, color: '#444', fontWeight: 'bold' },
                  interactivity: true,
                  width: 15,
                  labelPadding: 15
                },
                link: {
                  colorMode: 'gradient', // Creates that beautiful soft flow
                  colors: colors,
                  fillOpacity: 0.2 // Soft pastel look
                }
              }
            };

            var chart = new google.visualization.Sankey(document.getElementById('sankey_main'));
            chart.draw(data, options);
          }
        </script>
    </body>
    </html>
    